# SCR-002: マップ画面

## 基本情報

| 項目 | 内容 |
|:---|:---|
| 画面ID | SCR-002 |
| 画面名 | マップ |
| 対応機能 | F-05 記録の地図表示 |

## 画面レイアウト

```
┌─────────────────────────────────┐
│ マップ           [🔍] [⚙️]     │
├─────────────────────────────────┤
│                                 │
│    ┌─────────────────────┐      │
│    │                     │      │
│    │    Google Maps      │      │
│    │                     │      │
│    │   📍 📍            │      │
│    │        📍   📍     │      │
│    │    📍              │      │
│    │                     │      │
│    │              [◎]   │      │
│    └─────────────────────┘      │
│                                 │
│  ┌─────────────────────────┐    │
│  │ 📷 ラーメン二郎 ⭐4.5   │←── ピンタップ時の
│  │ 2024/12/01 | 友人と     │    ポップアップ
│  └─────────────────────────┘    │
│                                 │
│            [＋]                 │←── FAB（新規記録）
│                                 │
├─────────────────────────────────┤
│   [📋]        [🗺️]             │
│   ホーム       マップ            │
└─────────────────────────────────┘
```

## UI要素詳細

### ナビゲーションバー

| 要素ID | 種類 | アクション |
|:---|:---|:---|
| btn_search | Icon Button | 検索モーダル表示 |
| btn_settings | Icon Button | 設定画面へ遷移 |

### 地図エリア

| 要素ID | 種類 | 説明 |
|:---|:---|:---|
| map_view | MapView | Google Maps表示エリア |
| btn_location | FAB (小) | 現在地にフォーカス |
| pin_marker | Custom Marker | 記録位置を示すピン |

### ピンポップアップ

| 要素ID | 種類 | 説明 |
|:---|:---|:---|
| popup_thumbnail | Image | 記録のサムネイル画像 |
| popup_title | Label | 店舗名 |
| popup_rating | Rating | 評価（星表示） |
| popup_date | Label | 訪問日 |
| popup_companion | Label | 同行者 |

### フローティングアクションボタン

| 要素ID | 種類 | アクション |
|:---|:---|:---|
| fab_create | FAB | 新規記録作成画面へ |

### タブバー

| 要素ID | 種類 | アクション |
|:---|:---|:---|
| tab_home | Tab Item | ホーム画面へ切替 |
| tab_map | Tab Item | 現在の画面（アクティブ） |

## 地図仕様

### 初期表示

| 項目 | 値 |
|:---|:---|
| 初期中心 | ユーザーの現在地（許可時）または東京駅 |
| 初期ズーム | 14 |
| 地図タイプ | 標準 |

### ピン表示

| 条件 | 表示 |
|:---|:---|
| 評価 4.5以上 | ゴールドピン |
| 評価 3.0-4.4 | オレンジピン |
| 評価 3.0未満 | グレーピン |

### クラスタリング

- ズームアウト時に近接ピンをクラスタ化
- クラスタには記録数を表示
- クラスタタップでズームイン

## 状態管理

### 画面状態

| 状態 | 説明 |
|:---|:---|
| loading | 記録データ読み込み中 |
| loaded | 地図とピン表示完了 |
| empty | 記録なし（空状態表示） |
| error | データ取得エラー |

### 空状態表示

```
┌─────────────────────────────────┐
│                                 │
│       [地図のみ表示]            │
│                                 │
│    まだ記録がありません          │
│                                 │
│    [最初の記録を作成]            │
│                                 │
└─────────────────────────────────┘
```

## API連携

| タイミング | API | 説明 |
|:---|:---|:---|
| 画面表示時 | GET /records | 全記録を取得 |
| Pull to Refresh | - | 地図を再描画 |

## 遷移先

| アクション | 遷移先 |
|:---|:---|
| FABタップ | SCR-003 記録作成画面 |
| ピンポップアップタップ | SCR-004 記録詳細画面 |
| ホームタブタップ | SCR-001 ホーム画面 |
| 設定アイコンタップ | 設定画面 |
